# Webhook Security Demo â€” HMAC + Nonce + Timestamp

This project demonstrates a secure webhook implementation in **Node.js** using:

- **HMAC (Hash-based Message Authentication Code)** â€” Ensures the payload is authentic and unchanged.
- **Timestamp** â€” Rejects old requests to prevent delayed replay attacks.
- **Nonce (One-Time ID)** â€” Prevents replay within the allowed time window.

---

## ğŸ” Why This Matters

When your server receives a webhook from a 3rd-party app, how do you know:

- The request wasnâ€™t tampered with?
- It wasnâ€™t resent by an attacker later (replay attack)?
- Itâ€™s actually coming from the trusted sender?

This demo answers those questions by combining:

1. **Shared Secret** â€” Only sender & receiver know it.
2. **HMAC Signature** â€” Generated by hashing (`timestamp + '.' + nonce + '.' + payload`) with the secret.
3. **Freshness Check** â€” Timestamp must be within a small time window (default 5 min).
4. **Nonce Tracking** â€” Rejects any nonce thatâ€™s already been seen.

---

## ğŸ“‚ Project Structure

                                                (Setup Phase - done once)
                                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                 â”‚  You (Server Owner)        â”‚
                                 â”‚  - Pick WEBHOOK_SECRET     â”‚
                                 â”‚  - Configure on:           â”‚
                                 â”‚    a) Your server code     â”‚
                                 â”‚    b) GitHub/Stripe config â”‚
                                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                               â”‚
                                               â”‚ Shared via dashboard setup, NOT over the network
                                               â–¼
                                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                 â”‚  Webhook Sender            â”‚
                                 â”‚  (GitHub/Stripe)           â”‚
                                 â”‚  - Stores WEBHOOK_SECRET   â”‚
                                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                
                                
                                                (Every Webhook Event)
                                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                 â”‚ Webhook Sender              â”‚
                                 â”‚ 1. Takes JSON payload       â”‚
                                 â”‚ 2. Computes:                â”‚
                                 â”‚    signature = HMAC_SHA256( â”‚
                                 â”‚        payload,             â”‚
                                 â”‚        WEBHOOK_SECRET       â”‚
                                 â”‚    )                        â”‚
                                 â”‚ 3. Sends:                   â”‚
                                 â”‚    POST /webhook            â”‚
                                 â”‚    x-signature: <signature> â”‚
                                 â”‚    body: <payload>          â”‚
                                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                               â”‚
                                               â–¼
                                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                 â”‚ Your Server                 â”‚
                                 â”‚ 1. Receives request         â”‚
                                 â”‚ 2. Reads x-signature header â”‚
                                 â”‚ 3. Computes:                â”‚
                                 â”‚    expected = HMAC_SHA256(  â”‚
                                 â”‚        payload,             â”‚
                                 â”‚        WEBHOOK_SECRET       â”‚
                                 â”‚    )                        â”‚
                                 â”‚ 4. Compares:                â”‚
                                 â”‚    if expected === signatureâ”‚
                                 â”‚        âœ… Accept            â”‚
                                 â”‚    else                     â”‚
                                 â”‚        âŒ Reject            â”‚
                                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                

---

## ğŸš€ How It Works

### 1. Sender
The webhook sender:
- Generates a `timestamp` and `nonce`.
- Builds a payload (JSON).
- Creates an HMAC signature:

```js
const signature = crypto
  .createHmac('sha256', WEBHOOK_SECRET)
  .update(`${timestamp}.${nonce}.${JSON.stringify(payload)}`)
  .digest('hex');

